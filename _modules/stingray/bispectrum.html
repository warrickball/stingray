<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>stingray.bispectrum &#8212; stingray v</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-astropy.css?v=9d21690f" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=2afd17ea" />
    
    <script src="../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../_static/copybutton.js"></script>
    <link rel="icon" href="../../_static/stingray_logo.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../index.html"><span id="logotext1">Sting</span><span id="logotext2">ray</span><span id="logotext3">:docs</span></a>
  <ul>
    
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li>
	<a href="../../index.html">stingray v</a>
	 &#187;
      </li>
      <li><a href="../index.html" accesskey="U">Module code</a> &#187;</li>
      
       
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for stingray.bispectrum</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.linalg</span> <span class="kn">import</span> <span class="n">toeplitz</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">scipy.linalg</span> <span class="kn">import</span> <span class="n">hankel</span>

<span class="kn">from</span> <span class="nn">stingray</span> <span class="kn">import</span> <span class="n">lightcurve</span>
<span class="kn">import</span> <span class="nn">stingray.utils</span> <span class="k">as</span> <span class="nn">utils</span>
<span class="kn">from</span> <span class="nn">stingray.utils</span> <span class="kn">import</span> <span class="n">fftshift</span><span class="p">,</span> <span class="n">fft2</span><span class="p">,</span> <span class="n">ifftshift</span><span class="p">,</span> <span class="n">fft</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Bispectrum&quot;</span><span class="p">]</span>


<div class="viewcode-block" id="Bispectrum">
<a class="viewcode-back" href="../../api.html#stingray.bispectrum.Bispectrum">[docs]</a>
<span class="k">class</span> <span class="nc">Bispectrum</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Makes a :class:`Bispectrum` object from a :class:`stingray.Lightcurve`.</span>

<span class="sd">    :class:`Bispectrum` is a higher order time series analysis method and is calculated by</span>
<span class="sd">    indirect method as Fourier transform of triple auto-correlation function also called as</span>
<span class="sd">    3rd order cumulant.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lc : :class:`stingray.Lightcurve` object</span>
<span class="sd">        The light curve data for bispectrum calculation.</span>

<span class="sd">    maxlag : int, optional, default ``None``</span>
<span class="sd">        Maximum lag on both positive and negative sides of</span>
<span class="sd">        3rd order cumulant (Similar to lags in correlation).</span>
<span class="sd">        if ``None``, max lag is set to one-half of length of light curve.</span>

<span class="sd">    window : {``uniform``, ``parzen``, ``hamming``, ``hanning``, ``triangular``, ``welch``, ``blackman``, ``flat-top``}, optional, default &#39;uniform&#39;</span>
<span class="sd">        Type of window function to apply to the data.</span>

<span class="sd">    scale : {``biased``, ``unbiased``}, optional, default ``biased``</span>
<span class="sd">        Flag to decide biased or unbiased normalization for 3rd order cumulant function.</span>


<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    lc : :class:`stingray.Lightcurve` object</span>
<span class="sd">        The light curve data to compute the :class:`Bispectrum`.</span>

<span class="sd">    fs : float</span>
<span class="sd">        Sampling frequencies</span>

<span class="sd">    n : int</span>
<span class="sd">        Total Number of samples of light curve observations.</span>

<span class="sd">    maxlag : int</span>
<span class="sd">        Maximum lag on both positive and negative sides of</span>
<span class="sd">        3rd order cumulant (similar to lags in correlation)</span>

<span class="sd">    signal : numpy.ndarray</span>
<span class="sd">        Row vector of light curve counts for matrix operations</span>

<span class="sd">    scale : {``biased``, ``unbiased``}</span>
<span class="sd">        Flag to decide biased or unbiased normalization for 3rd order cumulant function.</span>

<span class="sd">    lags : numpy.ndarray</span>
<span class="sd">        An array of time lags for which 3rd order cumulant is calculated</span>

<span class="sd">    freq : numpy.ndarray</span>
<span class="sd">        An array of freq values for :class:`Bispectrum`.</span>

<span class="sd">    cum3 : numpy.ndarray</span>
<span class="sd">        A ``maxlag*2+1 x maxlag*2+1`` matrix containing 3rd order cumulant data for different lags.</span>

<span class="sd">    bispec : numpy.ndarray</span>
<span class="sd">        A`` maxlag*2+1 x maxlag*2+1`` matrix containing bispectrum data for different frequencies.</span>

<span class="sd">    bispec_mag : numpy.ndarray</span>
<span class="sd">        Magnitude of the bispectrum</span>

<span class="sd">    bispec_phase : numpy.ndarray</span>
<span class="sd">        Phase of the bispectrum</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    1) The biphase explained: understanding the asymmetries invcoupled Fourier components of astronomical timeseries</span>
<span class="sd">    by Thomas J. Maccarone Department of Physics, Box 41051, Science Building, Texas Tech University, Lubbock TX 79409-1051</span>
<span class="sd">    School of Physics and Astronomy, University of Southampton, SO16 4ES</span>

<span class="sd">    2) T. S. Rao, M. M. Gabr, An Introduction to Bispectral Analysis and Bilinear Time</span>
<span class="sd">    Series Models, Lecture Notes in Statistics, Volume 24, D. Brillinger, S. Fienberg,</span>
<span class="sd">    J. Gani, J. Hartigan, K. Krickeberg, Editors, Springer-Verlag, New York, NY, 1984.</span>

<span class="sd">    3) Matlab version of bispectrum under following link.</span>
<span class="sd">    https://www.mathworks.com/matlabcentral/fileexchange/60-bisp3cum</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    ::</span>

<span class="sd">       &gt;&gt; from stingray.lightcurve import Lightcurve</span>
<span class="sd">       &gt;&gt; from stingray.bispectrum import Bispectrum</span>
<span class="sd">       &gt;&gt; lc = Lightcurve([1,2,3,4,5],[2,3,1,1,2])</span>
<span class="sd">       &gt;&gt; bs = Bispectrum(lc,maxlag=1)</span>
<span class="sd">       &gt;&gt; bs.lags</span>
<span class="sd">       array([-1.,  0.,  1.])</span>
<span class="sd">       &gt;&gt; bs.freq</span>
<span class="sd">       array([-0.5,  0.,  0.5])</span>
<span class="sd">       &gt;&gt; bs.cum3</span>
<span class="sd">       array([[-0.2976,  0.1024,  0.1408],</span>
<span class="sd">           [ 0.1024,  0.144, -0.2976],</span>
<span class="sd">           [ 0.1408, -0.2976,  0.1024]])</span>
<span class="sd">       &gt;&gt; bs.bispec_mag</span>
<span class="sd">       array([[ 1.26336794,  0.0032   ,  0.0032    ],</span>
<span class="sd">           [ 0.0032   ,  0.16     ,  0.0032    ],</span>
<span class="sd">           [ 0.0032   ,  0.0032   ,  1.26336794]])</span>
<span class="sd">       &gt;&gt; bs.bispec_phase</span>
<span class="sd">       array([[ -9.65946229e-01,   2.25347190e-14,   3.46944695e-14],</span>
<span class="sd">           [  0.00000000e+00,   3.14159265e+00,   0.00000000e+00],</span>
<span class="sd">           [ -3.46944695e-14,  -2.25347190e-14,   9.65946229e-01]])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lc</span><span class="p">,</span> <span class="n">maxlag</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s2">&quot;biased&quot;</span><span class="p">):</span>
        <span class="c1"># Function call to create Bispectrum Object</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_bispetrum</span><span class="p">(</span><span class="n">lc</span><span class="p">,</span> <span class="n">maxlag</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_make_bispetrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lc</span><span class="p">,</span> <span class="n">maxlag</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">scale</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Makes a Bispectrum Object with given lighcurve, maxlag and scale.</span>

<span class="sd">        Helper method.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lc</span><span class="p">,</span> <span class="n">lightcurve</span><span class="o">.</span><span class="n">Lightcurve</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;lc must be a lightcurve.ightcurve object&quot;</span><span class="p">)</span>

        <span class="c1"># Available Windows. Used to resolve window paramneter</span>
        <span class="n">WINDOWS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;uniform&quot;</span><span class="p">,</span>
            <span class="s2">&quot;parzen&quot;</span><span class="p">,</span>
            <span class="s2">&quot;hamming&quot;</span><span class="p">,</span>
            <span class="s2">&quot;hanning&quot;</span><span class="p">,</span>
            <span class="s2">&quot;triangular&quot;</span><span class="p">,</span>
            <span class="s2">&quot;welch&quot;</span><span class="p">,</span>
            <span class="s2">&quot;blackmann&quot;</span><span class="p">,</span>
            <span class="s2">&quot;flat-top&quot;</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="k">if</span> <span class="n">window</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Window must be specified as string!&quot;</span><span class="p">)</span>
            <span class="n">window</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">window</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">WINDOWS</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Wrong window specified or window function is not available&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lc</span> <span class="o">=</span> <span class="n">lc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">lc</span><span class="o">.</span><span class="n">dt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lc</span><span class="o">.</span><span class="n">n</span>

        <span class="k">if</span> <span class="n">maxlag</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># if maxlag is not specified, it is set to half of length of lightcurve</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">maxlag</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lc</span><span class="o">.</span><span class="n">n</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">maxlag</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;maxlag must be an integer&quot;</span><span class="p">)</span>

            <span class="c1"># if negative maxlag is entered, convert it to +ve</span>
            <span class="k">if</span> <span class="n">maxlag</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">maxlag</span> <span class="o">=</span> <span class="o">-</span><span class="n">maxlag</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">maxlag</span> <span class="o">=</span> <span class="n">maxlag</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;scale must be a string&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">scale</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;biased&quot;</span><span class="p">,</span> <span class="s2">&quot;unbiased&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;scale can only be either &#39;biased&#39; or &#39;unbiased&#39;.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">window</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">window_name</span> <span class="o">=</span> <span class="s2">&quot;No Window&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">window</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">window_name</span> <span class="o">=</span> <span class="n">window</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_window</span><span class="p">()</span>

        <span class="c1"># Other Attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cum3</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">freq</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bispec</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bispec_mag</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bispec_phase</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># converting to a row vector to apply matrix operations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">lc</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lc</span><span class="o">.</span><span class="n">counts</span><span class="p">)))</span>

        <span class="c1"># Mean subtraction before bispecrum calculation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">lc</span><span class="o">.</span><span class="n">counts</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_cumulant3</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_normalize_cumulant3</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cal_bispec</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_get_window</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a window function of self.window_name type</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">N</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlag</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">window_even</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">create_window</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_name</span><span class="p">)</span>

        <span class="c1"># 2d even window</span>
        <span class="n">window2d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">window_even</span><span class="p">,</span>
            <span class="p">]</span>
            <span class="o">*</span> <span class="n">N</span>
        <span class="p">)</span>

        <span class="c1">## One-sided window with zero padding</span>
        <span class="n">window</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">window</span><span class="p">[:</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlag</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">window_even</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">maxlag</span> <span class="p">:]</span>
        <span class="n">window</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">maxlag</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># 2d window function to apply to bispectrum</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="n">window</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlag</span><span class="p">)))</span>
        <span class="n">toep_matrix</span> <span class="o">=</span> <span class="n">toeplitz</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
        <span class="n">toep_matrix</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril</span><span class="p">(</span><span class="n">toep_matrix</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">window</span> <span class="o">=</span> <span class="n">toep_matrix</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">window2d</span> <span class="o">*</span> <span class="n">window2d</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">window</span>

    <span class="k">def</span> <span class="nf">_cumulant3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the 3rd Order cummulant of the lightcurve.</span>

<span class="sd">        Assigns</span>
<span class="sd">        -------</span>
<span class="sd">        self.cum3,</span>
<span class="sd">        self.lags</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialize square cumulant matrix if zeros</span>
        <span class="n">cum3_dim</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlag</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cum3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">cum3_dim</span><span class="p">,</span> <span class="n">cum3_dim</span><span class="p">))</span>

        <span class="c1"># calculate lags for different values of 3rd order cumulant</span>
        <span class="n">lagindex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">maxlag</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlag</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="o">=</span> <span class="n">lagindex</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lc</span><span class="o">.</span><span class="n">dt</span>

        <span class="c1"># Defines indices for matrices</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlag</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
        <span class="n">ind_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxlag</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
        <span class="n">zero_maxlag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlag</span><span class="p">))</span>
        <span class="n">zero_maxlag_t</span> <span class="o">=</span> <span class="n">zero_maxlag</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

        <span class="n">sig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

        <span class="n">rev_signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">[</span><span class="mi">0</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sig</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="n">zero_maxlag_t</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">rev_signal</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">ind_t</span><span class="p">],</span> <span class="n">zero_maxlag</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># converts row and column into a toeplitz matrix</span>
        <span class="n">toep</span> <span class="o">=</span> <span class="n">toeplitz</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
        <span class="n">rev_signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">rev_signal</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlag</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Calculates Cummulant of 1D signal i.e. Lightcurve counts</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cum3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cum3</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">toep</span><span class="p">,</span> <span class="n">rev_signal</span><span class="p">),</span> <span class="n">toep</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_normalize_cumulant3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Scales (biased or ubiased) the 3rd Order cumulant of the lightcurve .</span>

<span class="sd">        Updates</span>
<span class="sd">        -------</span>
<span class="sd">        seff.cum3</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Biased scaling of cummulant</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">==</span> <span class="s2">&quot;biased&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cum3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cum3</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># unbiased Scaling of cummulant</span>
            <span class="n">maxlag1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlag</span> <span class="o">+</span> <span class="mi">1</span>

            <span class="c1"># Scaling matrix initialized used to do unbiased normalization of cumulant</span>
            <span class="n">scal_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">maxlag1</span><span class="p">,</span> <span class="n">maxlag1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int64&quot;</span><span class="p">)</span>

            <span class="c1"># Calculate scaling matrix for unbiased normalization</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxlag1</span><span class="p">):</span>
                <span class="n">maxlag1k</span> <span class="o">=</span> <span class="n">maxlag1</span> <span class="o">-</span> <span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">scal_matrix</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span><span class="n">maxlag1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="n">maxlag1k</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxlag1k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">scal_matrix</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">scal_matrix</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

            <span class="n">maxlag1ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxlag</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">lagdiff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="n">maxlag1</span>

            <span class="c1"># Rows and columns for Toeplitz matrix</span>
            <span class="n">col</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">lagdiff</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">col</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">)))</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
            <span class="n">row</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">lagdiff</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlag</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">row</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">)))</span>

            <span class="c1"># Toeplitz matrix</span>
            <span class="n">toep_matrix</span> <span class="o">=</span> <span class="n">toeplitz</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
            <span class="c1"># Matrix used to concatenate with scaling matrix</span>
            <span class="n">conc_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">scal_matrix</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">maxlag</span><span class="p">,</span> <span class="n">maxlag1ind</span><span class="p">]])</span>
            <span class="n">join_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">toep_matrix</span><span class="p">,</span> <span class="n">conc_mat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">scal_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">scal_matrix</span><span class="p">,</span> <span class="n">join_matrix</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">co_mat</span> <span class="o">=</span> <span class="n">scal_matrix</span><span class="p">[</span><span class="n">maxlag1ind</span><span class="p">,</span> <span class="p">:]</span>
            <span class="n">co_mat</span> <span class="o">=</span> <span class="n">co_mat</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlag</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)]</span>

            <span class="c1"># Scaling matrix calculated</span>
            <span class="n">scal_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">scal_matrix</span><span class="p">,</span> <span class="n">co_mat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="c1"># Set numbers less than 1 to be equal to 1</span>
            <span class="n">scal_matrix</span><span class="p">[</span><span class="n">scal_matrix</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cum3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cum3</span><span class="p">,</span> <span class="n">scal_matrix</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cal_bispec</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates bispectrum as a fourier transform of 3rd Order Cumulant.</span>

<span class="sd">        Attributes</span>
<span class="sd">        ----------</span>
<span class="sd">        self.freq</span>
<span class="sd">        self.bispec</span>
<span class="sd">        self.bispec_mag</span>
<span class="sd">        self.bispec_phase</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">freq</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">lc</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlag</span>

        <span class="c1"># Apply window if specified otherwise calculate with applying window</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bispec</span> <span class="o">=</span> <span class="n">fftshift</span><span class="p">(</span><span class="n">fft2</span><span class="p">(</span><span class="n">ifftshift</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cum3</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bispec</span> <span class="o">=</span> <span class="n">fftshift</span><span class="p">(</span><span class="n">fft2</span><span class="p">(</span><span class="n">ifftshift</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cum3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">)))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">bispec_mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bispec</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bispec_phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">bispec</span><span class="p">))</span>

<div class="viewcode-block" id="Bispectrum.plot_cum3">
<a class="viewcode-back" href="../../api.html#stingray.bispectrum.Bispectrum.plot_cum3">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_cum3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the 3rd order cumulant as function of time lags using ``matplotlib``.</span>
<span class="sd">        Plot the ``cum3`` attribute on a graph with the ``lags`` attribute on x-axis and y-axis and</span>
<span class="sd">        ``cum3`` on z-axis</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        axis : list, tuple, string, default ``None``</span>
<span class="sd">            Parameter to set axis properties of ``matplotlib`` figure. For example</span>
<span class="sd">            it can be a list like ``[xmin, xmax, ymin, ymax]`` or any other</span>
<span class="sd">            acceptable argument for ``matplotlib.pyplot.axis()`` method.</span>

<span class="sd">        save : bool, optionalm, default ``False``</span>
<span class="sd">            If ``True``, save the figure with specified filename.</span>

<span class="sd">        filename : str</span>
<span class="sd">            File name and path of the image to save. Depends on the boolean ``save``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        plt : ``matplotlib.pyplot`` object</span>
<span class="sd">            Reference to plot, call ``show()`` to display it</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cont</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cum3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Spectral_r</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cont</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;3rd Order Cumulant&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;lags 1&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;lags 2&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;bispec_cum3.png&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plt</span></div>


<div class="viewcode-block" id="Bispectrum.plot_mag">
<a class="viewcode-back" href="../../api.html#stingray.bispectrum.Bispectrum.plot_mag">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_mag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the magnitude of bispectrum as function of freq using ``matplotlib``.</span>
<span class="sd">        Plot the ``bispec_mag`` attribute on a graph with ``freq`` attribute on the x-axis and y-axis and</span>
<span class="sd">        the ``bispec_mag`` attribute on the z-axis.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        axis : list, tuple, string, default ``None``</span>
<span class="sd">            Parameter to set axis properties of ``matplotlib`` figure. For example</span>
<span class="sd">            it can be a list like ``[xmin, xmax, ymin, ymax]`` or any other</span>
<span class="sd">            acceptable argument for ``matplotlib.pyplot.axis()`` method.</span>

<span class="sd">        save : bool, optional, default ``False``</span>
<span class="sd">            If ``True``, save the figure with specified filename and path.</span>

<span class="sd">        filename : str</span>
<span class="sd">            File name and path of the image to save. Depends on the bool ``save``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        plt : ``matplotlib.pyplot`` object</span>
<span class="sd">            Reference to plot, call ``show()`` to display it</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">cont</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">freq</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bispec_mag</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Spectral_r</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cont</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Bispectrum Magnitude&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;freq 1&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;freq 2&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;bispec_mag.png&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plt</span></div>


<div class="viewcode-block" id="Bispectrum.plot_phase">
<a class="viewcode-back" href="../../api.html#stingray.bispectrum.Bispectrum.plot_phase">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the phase of bispectrum as function of freq using ``matplotlib``.</span>
<span class="sd">        Plot the ``bispec_phase`` attribute on a graph with ``phase`` attribute on the x-axis and</span>
<span class="sd">        y-axis and the ``bispec_phase`` attribute on the z-axis.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        axis : list, tuple, string, default ``None``</span>
<span class="sd">            Parameter to set axis properties of ``matplotlib`` figure. For example</span>
<span class="sd">            it can be a list like ``[xmin, xmax, ymin, ymax]`` or any other</span>
<span class="sd">            acceptable argument for ``matplotlib.pyplot.axis()`` function.</span>

<span class="sd">        save : bool, optional, default ``False``</span>
<span class="sd">            If ``True``, save the figure with specified filename and path.</span>

<span class="sd">        filename : str</span>
<span class="sd">            File name and path of the image to save. Depends on the bool ``save``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        plt : ``matplotlib.pyplot`` object</span>
<span class="sd">            Reference to plot, call ``show()`` to display it</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">cont</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">freq</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bispec_phase</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Spectral_r</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cont</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Bispectrum Phase&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;freq 1&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;freq 2&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>

        <span class="c1"># Save figure</span>
        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;bispec_phase.png&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plt</span></div>
</div>

</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right"> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2024, [{&#39;name&#39;: &#39;Stingray Developers&#39;, &#39;email&#39;: &#39;spectraltiming-stingray@googlegroups.com&#39;}].<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 8.0.2. &nbsp;
    Last built 09 Oct 2024. <br/>
  </p>
</footer>
  </body>
</html>