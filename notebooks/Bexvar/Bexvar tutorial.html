<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Baysian Excess Variance (Bexvar) &#8212; stingray v</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-astropy.css?v=9d21690f" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=2afd17ea" />
    
    <script src="../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../_static/copybutton.js"></script>
    <link rel="icon" href="../../_static/stingray_logo.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Install Stingray in colab" href="../Multitaper/multitaper_example.html" />
    <link rel="prev" title="Bispectrum Tutorial" href="../Bispectrum/bispectrum_tutorial.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../index.html"><span id="logotext1">Sting</span><span id="logotext2">ray</span><span id="logotext3">:docs</span></a>
  <ul>
    
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="../Multitaper/multitaper_example.html" title="Install Stingray in colab">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="../Bispectrum/bispectrum_tutorial.html" title="Bispectrum Tutorial">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../../index.html">stingray v</a>
	 &#187;
      </li>
      <li><a href="../../core.html" accesskey="U">Core Stingray Functionality</a> &#187;</li>
      
      <li>Baysian Excess Variance (Bexvar)</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="Baysian-Excess-Variance-(Bexvar)">
<h1>Baysian Excess Variance (Bexvar)<a class="headerlink" href="#Baysian-Excess-Variance-(Bexvar)" title="Link to this heading">Â¶</a></h1>
<p>The Bayesian Excess Variance (bexvar) is a statistical measurement of variability in Poisson-distributed light curves. Bexvar is a Bayesian formulation of excess variance. A brief summary of theoretical understanding of bexvar is given at the end of this tutorial.</p>
<div class="line-block">
<div class="line">The <code class="docutils literal notranslate"><span class="pre">bexvar()</span></code> method implemented in Stingray, provides posterior samples of bexvar given a light curve data as input parameters.</div>
<div class="line">This tutorial is intended to give a demonstration of How to use <code class="docutils literal notranslate"><span class="pre">bexvar()</span></code> method implemented in Stingray. The method takes following input parameters. (Given here for completeness)</div>
</div>
<div class="line-block">
<div class="line">â€ƒâ€ƒ<code class="docutils literal notranslate"><span class="pre">time</span></code> : iterable, <code class="docutils literal notranslate"><span class="pre">:class:numpy.array</span></code> or <code class="docutils literal notranslate"><span class="pre">:class:List</span></code> of floats, optional, default <code class="docutils literal notranslate"><span class="pre">None</span></code></div>
<div class="line">â€ƒâ€ƒâ€ƒâ€ƒ A list or array of time stamps for a light curve.</div>
<div class="line">â€ƒâ€ƒ<code class="docutils literal notranslate"><span class="pre">time_del</span></code> : iterable, <code class="docutils literal notranslate"><span class="pre">:class:numpy.array</span></code> or <code class="docutils literal notranslate"><span class="pre">:class:List</span></code> of floats</div>
<div class="line">â€ƒâ€ƒâ€ƒâ€ƒA list or array of time intervals for each bin of light curve.</div>
<div class="line">â€ƒâ€ƒ<code class="docutils literal notranslate"><span class="pre">src_counts</span></code> : iterable, <code class="docutils literal notranslate"><span class="pre">:class:numpy.array</span></code> or <code class="docutils literal notranslate"><span class="pre">:class:List</span></code> of floats</div>
<div class="line">â€ƒâ€ƒâ€ƒâ€ƒA list or array of counts observed from source region in each bin.</div>
<div class="line">â€ƒâ€ƒ<code class="docutils literal notranslate"><span class="pre">bg_counts</span></code> : iterable, <code class="docutils literal notranslate"><span class="pre">:class:numpy.array</span></code> or <code class="docutils literal notranslate"><span class="pre">:class:List</span></code> of floats, optional, default <code class="docutils literal notranslate"><span class="pre">None</span></code></div>
<div class="line">â€ƒâ€ƒâ€ƒâ€ƒA list or array of counts observed from background region in each bin. If <code class="docutils literal notranslate"><span class="pre">None</span></code></div>
<div class="line">â€ƒâ€ƒâ€ƒâ€ƒwe assume it as a numpy array of zeros, of length equal to length of <code class="docutils literal notranslate"><span class="pre">src_counts</span></code>.</div>
<div class="line">â€ƒâ€ƒ<code class="docutils literal notranslate"><span class="pre">bg_ratio</span></code> : iterable, <code class="docutils literal notranslate"><span class="pre">:class:numpy.array</span></code> or <code class="docutils literal notranslate"><span class="pre">:class:List</span></code> of floats, optional, default <code class="docutils literal notranslate"><span class="pre">None</span></code></div>
<div class="line">â€ƒâ€ƒâ€ƒâ€ƒA list or array of source region area to background region area ratio in each bin.</div>
<div class="line">â€ƒâ€ƒâ€ƒâ€ƒIf <code class="docutils literal notranslate"><span class="pre">None</span></code> we assume it as a numpy array of ones, of length equal to the length of</div>
<div class="line">â€ƒâ€ƒâ€ƒâ€ƒ<code class="docutils literal notranslate"><span class="pre">src_counts</span></code>.</div>
<div class="line">â€ƒâ€ƒ<code class="docutils literal notranslate"><span class="pre">frac_exp</span></code> : iterable, <code class="docutils literal notranslate"><span class="pre">:class:numpy.array</span></code> or <code class="docutils literal notranslate"><span class="pre">:class:List</span></code> of floats, optional, default <code class="docutils literal notranslate"><span class="pre">None</span></code></div>
<div class="line">â€ƒâ€ƒâ€ƒâ€ƒA list or array of fractional exposers in each bin. If <code class="docutils literal notranslate"><span class="pre">None</span></code> we assume it as</div>
<div class="line">â€ƒâ€ƒâ€ƒâ€ƒa numpy array of ones, of length equal to length of <code class="docutils literal notranslate"><span class="pre">src_counts</span></code>.</div>
</div>
<p>Let us start by importing the bexvar module</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">stingray</span> <span class="kn">import</span> <span class="n">bexvar</span>
</pre></div>
</div>
</div>
<p>Now consider an example dataset.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span>
<span class="n">counts</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">106</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">148</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">129</span><span class="p">,</span> <span class="mi">204</span><span class="p">,</span> <span class="mi">87</span><span class="p">])</span>
<span class="n">time_del</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">time</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span>
<span class="n">bg_counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">722</span><span class="p">,</span> <span class="mi">696</span><span class="p">,</span> <span class="mi">701</span><span class="p">,</span> <span class="mi">721</span><span class="p">,</span> <span class="mi">722</span><span class="p">,</span> <span class="mi">703</span><span class="p">,</span> <span class="mi">722</span><span class="p">,</span> <span class="mi">695</span><span class="p">])</span>
<span class="n">bg_ratio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.01474</span><span class="p">,</span> <span class="mf">0.01158</span><span class="p">,</span> <span class="mf">0.01214</span><span class="p">,</span> <span class="mf">0.01308</span><span class="p">,</span> <span class="mf">0.010877</span><span class="p">,</span> <span class="mf">0.01177</span><span class="p">,</span> <span class="mf">0.01058</span><span class="p">,</span> <span class="mf">0.01138</span><span class="p">])</span>
<span class="n">frac_exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.37416</span><span class="p">,</span> <span class="mf">0.21713</span><span class="p">,</span> <span class="mf">0.37937</span><span class="p">,</span>  <span class="mf">0.50140</span><span class="p">,</span> <span class="mf">0.11617</span><span class="p">,</span> <span class="mf">0.39221</span><span class="p">,</span> <span class="mf">0.64275</span><span class="p">,</span> <span class="mf">0.31160</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>Call bexvar function to get posterior distribution of bexvar.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">bexvar()</span></code> method uses <a class="reference external" href="https://johannesbuchner.github.io/UltraNest/">UltraNest</a> python package to obtain the posteriors of bexvar. Ultranest gives a brief summary of log evidence (log(z)) and its uncertainties, and the parameter constraints.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><span></span> <span class="n">bexvar_distribution</span> <span class="o">=</span> <span class="n">bexvar</span><span class="o">.</span><span class="n">bexvar</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">src_counts</span><span class="o">=</span><span class="n">counts</span><span class="p">,</span> <span class="n">time_del</span><span class="o">=</span><span class="n">time_del</span><span class="p">,</span> <span class="n">frac_exp</span><span class="o">=</span><span class="n">frac_exp</span><span class="p">,</span>
                                     <span class="n">bg_counts</span><span class="o">=</span><span class="n">bg_counts</span><span class="p">,</span> <span class="n">bg_ratio</span><span class="o">=</span><span class="n">bg_ratio</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
preparing time bin posteriors...
running bexvar...
[ultranest] Sampling 400 live points from prior ...
[ultranest] Explored until L=-2e+01   [-20.4040..-20.4040]*| it/evals=3622/5046 eff=77.9595% N=400
[ultranest] Likelihood function evaluations: 5051
[ultranest]   logZ = -24.86 +- 0.0784
[ultranest] Effective samples strategy satisfied (ESS = 1590.2, need &gt;400)
[ultranest] Posterior uncertainty strategy is satisfied (KL: 0.47+-0.06 nat, need &lt;0.50 nat)
[ultranest] Evidency uncertainty strategy is satisfied (dlogz=0.08, need &lt;0.5)
[ultranest]   logZ error budget: single: 0.09 bs:0.08 tail:0.01 total:0.08 required:&lt;0.50
[ultranest] done iterating.

logZ = -24.856 +- 0.156
  single instance: logZ = -24.856 +- 0.093
  bootstrapped   : logZ = -24.856 +- 0.156
  tail           : logZ = +- 0.010
insert order U test : converged: True correlation: inf iterations

    logmean             : 0.350 â”‚ â– â– â–â–â–â–â–â–â–â–â–‚â–ƒâ–„â–…â–†â–‡â–‡â–‡â–†â–…â–„â–ƒâ–‚â–â–â–â–â–â–â– â– â–â– â”‚0.575     0.461 +- 0.020
    logsigma            : 0.010 â”‚â–‡â–…â–„â–ƒâ–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â– â–â–â–â–        â–     â– â”‚0.227     0.028 +- 0.018

running bexvar... done
</pre></div></div>
</div>
<p>We can then plot the samples to visualize the posterior distribution of bexvar.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bexvar_distribution</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;# of samples&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\sigma_</span><span class="si">{bexvar}</span><span class="s2">$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_Bexvar_Bexvar_tutorial_12_0.png" src="../../_images/notebooks_Bexvar_Bexvar_tutorial_12_0.png" />
</div>
</div>
<p>If the light curve is intrinsically variable, then the posterior distribution of bexvar should exclude low values. Users can compute the lower 10% quantile of the posterior, and use it as a variability indicator (see <a class="reference external" href="https://arxiv.org/abs/2106.14529">Buchner et al. (2021)</a>).</p>
<p>The method uses fractional exposers (<code class="docutils literal notranslate"><span class="pre">frac_exp</span></code>) in each bin to compute the count rates (i.e.<span class="math notranslate nohighlight">\(~\scriptstyle{R_i = C_i/(\Delta{t_i}\times f_i)}\)</span>). In its current form it only considers time bins with <code class="docutils literal notranslate"><span class="pre">frac_exp</span></code> &lt; 1. The <code class="docutils literal notranslate"><span class="pre">bg_ratio</span></code> parameter is used to scale the <code class="docutils literal notranslate"><span class="pre">bg_counts</span></code> to estimate counts in source region. The <code class="docutils literal notranslate"><span class="pre">bg_count</span></code>, <code class="docutils literal notranslate"><span class="pre">bg_ratio</span></code> and <code class="docutils literal notranslate"><span class="pre">frac_exp</span></code> are optional parameters, if they are not provided, the method defines default values for them as described in documentation.</p>
<p>Let us see an example to get bexvar distribution without these optional parameters.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span>
<span class="n">counts</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">106</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">148</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">129</span><span class="p">,</span> <span class="mi">204</span><span class="p">,</span> <span class="mi">87</span><span class="p">])</span>
<span class="n">time_del</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">time</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span>

<span class="n">bexvar_distribution</span> <span class="o">=</span> <span class="n">bexvar</span><span class="o">.</span><span class="n">bexvar</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">src_counts</span><span class="o">=</span><span class="n">counts</span><span class="p">,</span> <span class="n">time_del</span><span class="o">=</span><span class="n">time_del</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
preparing time bin posteriors...
running bexvar...
[ultranest] Sampling 400 live points from prior ...
[ultranest] Explored until L=-4e+01   [-36.8486..-36.8486]*| it/evals=3615/5101 eff=76.8985% N=400
[ultranest] Likelihood function evaluations: 5125
[ultranest]   logZ = -41.34 +- 0.09729
[ultranest] Effective samples strategy satisfied (ESS = 1692.4, need &gt;400)
[ultranest] Posterior uncertainty strategy is satisfied (KL: 0.46+-0.06 nat, need &lt;0.50 nat)
[ultranest] Evidency uncertainty strategy is satisfied (dlogz=0.10, need &lt;0.5)
[ultranest]   logZ error budget: single: 0.09 bs:0.10 tail:0.01 total:0.10 required:&lt;0.50
[ultranest] done iterating.

logZ = -41.331 +- 0.174
  single instance: logZ = -41.331 +- 0.092
  bootstrapped   : logZ = -41.335 +- 0.174
  tail           : logZ = +- 0.010
insert order U test : converged: True correlation: inf iterations

    logmean             : -0.517â”‚ â–  â–  â–â–â–â–â–â–â–â–â–â–â–‚â–‚â–ƒâ–„â–†â–‡â–‡â–†â–…â–„â–ƒâ–‚â–â–â–â–â–â–â–â–â– â”‚0.383     0.020 +- 0.081
    logsigma            : 0.029 â”‚ â–â–‚â–†â–‡â–‡â–…â–ƒâ–‚â–‚â–â–â–â–â–â–â–â– â–â–â–â–â–   â–         â– â”‚1.236     0.213 +- 0.074

running bexvar... done
</pre></div></div>
</div>
<section id="Bexvar:-Theoretical-background">
<h2>Bexvar: Theoretical background<a class="headerlink" href="#Bexvar:-Theoretical-background" title="Link to this heading">Â¶</a></h2>
<p>This section provides a theoretical understanding of Bayesian excess variance (bexvar). This is an optional read.</p>
<p>Given a lightcurve data <span class="math notranslate nohighlight">\({\scriptstyle ğ· = (ğ‘†_1,ğµ_1,~â€¦~,ğ‘†_ğ‘,ğµ_ğ‘)}\)</span> where (<span class="math notranslate nohighlight">\(\scriptstyle{S_i}\)</span>) denotes counts obtained from source region and (<span class="math notranslate nohighlight">\(\scriptstyle{B_i}\)</span>) denotes counts obtained from background extraction region in <span class="math notranslate nohighlight">\(\scriptstyle{i^{th}}\)</span> time bin. If it is assumed that the counts <span class="math notranslate nohighlight">\(\scriptstyle{ğ‘†_ğ‘–}\)</span> and <span class="math notranslate nohighlight">\(\scriptstyle{ğµ_ğ‘–}\)</span> can be expressed as Poisson processes.</p>
<div class="math notranslate nohighlight">
\[\scriptstyle {ğ‘†_ğ‘– ~ \sim ~ ğ‘ƒğ‘œğ‘–ğ‘ ğ‘ ğ‘œğ‘›((( ğ‘…_ğ‘†(ğ‘¡_ğ‘–) ~+~ ğ‘…_ğµ(ğ‘¡_ğ‘–) \times ğ‘Ÿ)~Ã—~ğ‘“_ğ‘–~\times~Î”ğ‘¡)}\]</div>
<div class="math notranslate nohighlight">
\[\scriptstyle  {ğµ_ğ‘– ~ \sim ~ ğ‘ƒğ‘œğ‘–ğ‘ ğ‘ ğ‘œğ‘›(ğ‘…_ğµ(ğ‘¡_ğ‘–) Ã— ğ‘“_ğ‘– Ã— Î”ğ‘¡)}\]</div>
<div class="line-block">
<div class="line">Here, <span class="math notranslate nohighlight">\(\scriptstyle{ğ‘…_ğ‘†(ğ‘¡_ğ‘–)}\)</span> is source count rate and <span class="math notranslate nohighlight">\(\scriptstyle{ğ‘…_B(ğ‘¡_ğ‘–)}\)</span> is background count rate in <span class="math notranslate nohighlight">\(\scriptstyle{i^{th}}\)</span> time bin.</div>
<div class="line">It is further assumed that <span class="math notranslate nohighlight">\(\scriptstyle{ğ‘…_ğ‘†(ğ‘¡_ğ‘–)}\)</span> is distributed according to a log normal distribution, with some unknown parameters (i.e., <span class="math notranslate nohighlight">\(\scriptstyle{log(\bar{ğ‘…_{S}})}\)</span>, and <span class="math notranslate nohighlight">\(\scriptstyle{\sigma_{bexvar}}\)</span>).</div>
</div>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\scriptstyle{log(ğ‘…_ğ‘†(ğ‘¡_ğ‘–))~\sim~ğ‘ğ‘œğ‘Ÿğ‘šğ‘ğ‘™(log(\bar{ğ‘…_ğ‘†}),~ \sigma_{ğ‘ğ‘’ğ‘¥ğ‘£ğ‘ğ‘Ÿ})}\]</div>
</div></blockquote>
<p>This <span class="math notranslate nohighlight">\(\sigma_{ğ‘ğ‘’ğ‘¥ğ‘£ğ‘ğ‘Ÿ}\)</span> provides intrinsic variability on log-count rate and it is defined as Bayesian excess variance (bexvar). The posterior distribution of <span class="math notranslate nohighlight">\(\sigma_{ğ‘ğ‘’ğ‘¥ğ‘£ğ‘ğ‘Ÿ}\)</span> can be used to identify intrinsically variable object.</p>
<p>The bexvar() method in Stingray returns posterior samples of <span class="math notranslate nohighlight">\(\scriptstyle{\sigma_{ğ‘ğ‘’ğ‘¥ğ‘£ğ‘ğ‘Ÿ}}\)</span> given a light curve data. The samples are generated following the same prescription given in <a class="reference external" href="https://arxiv.org/abs/2106.14529">Buchner et al. (2021)</a>. The method uses flat, uninformative priors on <span class="math notranslate nohighlight">\(\scriptstyle{log(\bar{ğ‘…_ğ‘†})}\)</span> and <span class="math notranslate nohighlight">\(\scriptstyle{log(\sigma_{ğ‘ğ‘’ğ‘¥ğ‘£ğ‘ğ‘Ÿ})}\)</span> and obtains the posterior samples using nested sampling Monte Carlo algorithm MLFriends (Buchner
<a class="reference external" href="https://link.springer.com/article/10.1007/s11222-014-9512-y">2016</a>, <a class="reference external" href="https://arxiv.org/abs/1707.04476">2019</a>) implemented in the <a class="reference external" href="https://johannesbuchner.github.io/UltraNest/">UltraNest</a> Python package (Buchner <a class="reference external" href="https://arxiv.org/abs/2101.09604">2021</a>).</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Baysian Excess Variance (Bexvar)</a><ul>
<li><a class="reference internal" href="#Bexvar:-Theoretical-background">Bexvar: Theoretical background</a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../../_sources/notebooks/Bexvar/Bexvar tutorial.ipynb.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2024, [{&#39;name&#39;: &#39;Stingray Developers&#39;, &#39;email&#39;: &#39;spectraltiming-stingray@googlegroups.com&#39;}].<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 8.0.2. &nbsp;
    Last built 09 Oct 2024. <br/>
  </p>
</footer>
  </body>
</html>